/* Tables for graphics library */

#include <math.h>
#include <stdlib.h>

#include "graph.h"

#define TABSIZE 4096

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
int sctab[TABSIZE + (TABSIZE / 4)] = {
0,2,3,5,6,8,9,11,13,14,16,17,19,20,22,24,
25,27,28,30,31,33,35,36,38,39,41,42,44,46,47,49,
50,52,53,55,57,58,60,61,63,64,66,67,69,71,72,74,
75,77,78,80,82,83,85,86,88,89,91,93,94,96,97,99,
100,102,103,105,107,108,110,111,113,114,116,118,119,121,122,124,
125,127,128,130,132,133,135,136,138,139,141,142,144,146,147,149,
150,152,153,155,156,158,160,161,163,164,166,167,169,170,172,174,
175,177,178,180,181,183,184,186,187,189,191,192,194,195,197,198,
200,201,203,204,206,207,209,211,212,214,215,217,218,220,221,223,
224,226,227,229,230,232,234,235,237,238,240,241,243,244,246,247,
249,250,252,253,255,256,258,259,261,263,264,266,267,269,270,272,
273,275,276,278,279,281,282,284,285,287,288,290,291,293,294,296,
297,299,300,302,303,305,306,308,309,311,312,314,315,317,318,320,
321,323,324,326,327,329,330,332,333,335,336,338,339,341,342,343,
345,346,348,349,351,352,354,355,357,358,360,361,363,364,366,367,
369,370,371,373,374,376,377,379,380,382,383,385,386,388,389,390,
392,393,395,396,398,399,401,402,403,405,406,408,409,411,412,414,
415,416,418,419,421,422,424,425,426,428,429,431,432,434,435,436,
438,439,441,442,443,445,446,448,449,451,452,453,455,456,458,459,
460,462,463,465,466,467,469,470,472,473,474,476,477,479,480,481,
483,484,485,487,488,490,491,492,494,495,497,498,499,501,502,503,
505,506,507,509,510,512,513,514,516,517,518,520,521,522,524,525,
526,528,529,530,532,533,535,536,537,539,540,541,543,544,545,547,
548,549,550,552,553,554,556,557,558,560,561,562,564,565,566,568,
569,570,572,573,574,575,577,578,579,581,582,583,584,586,587,588,
590,591,592,593,595,596,597,599,600,601,602,604,605,606,607,609,
610,611,613,614,615,616,618,619,620,621,623,624,625,626,628,629,
630,631,632,634,635,636,637,639,640,641,642,644,645,646,647,648,
650,651,652,653,654,656,657,658,659,660,662,663,664,665,666,668,
669,670,671,672,674,675,676,677,678,679,681,682,683,684,685,687,
688,689,690,691,692,693,695,696,697,698,699,700,702,703,704,705,
706,707,708,709,711,712,713,714,715,716,717,719,720,721,722,723,
724,725,726,727,729,730,731,732,733,734,735,736,737,738,739,741,
742,743,744,745,746,747,748,749,750,751,752,753,755,756,757,758,
759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,
775,776,777,778,779,780,782,783,784,785,786,787,788,789,790,791,
792,793,794,795,796,797,798,798,799,800,801,802,803,804,805,806,
807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,
822,823,824,825,826,827,828,829,830,831,832,833,834,834,835,836,
837,838,839,840,841,842,843,843,844,845,846,847,848,849,850,851,
851,852,853,854,855,856,857,857,858,859,860,861,862,863,863,864,
865,866,867,868,868,869,870,871,872,873,873,874,875,876,877,878,
878,879,880,881,882,882,883,884,885,885,886,887,888,889,889,890,
891,892,893,893,894,895,896,896,897,898,899,899,900,901,902,902,
903,904,905,905,906,907,907,908,909,910,910,911,912,913,913,914,
915,915,916,917,917,918,919,920,920,921,922,922,923,924,924,925,
926,926,927,928,928,929,930,930,931,932,932,933,934,934,935,936,
936,937,937,938,939,939,940,941,941,942,942,943,944,944,945,945,
946,947,947,948,948,949,950,950,951,951,952,953,953,954,954,955,
955,956,957,957,958,958,959,959,960,960,961,961,962,963,963,964,
964,965,965,966,966,967,967,968,968,969,969,970,970,971,971,972,
972,973,973,974,974,975,975,976,976,977,977,978,978,979,979,979,
980,980,981,981,982,982,983,983,983,984,984,985,985,986,986,986,
987,987,988,988,989,989,989,990,990,991,991,991,992,992,993,993,
993,994,994,994,995,995,996,996,996,997,997,997,998,998,998,999,
999,999,1000,1000,1000,1001,1001,1001,1002,1002,1002,1003,1003,1003,1004,1004,
1004,1005,1005,1005,1006,1006,1006,1006,1007,1007,1007,1008,1008,1008,1008,1009,
1009,1009,1009,1010,1010,1010,1010,1011,1011,1011,1011,1012,1012,1012,1012,1013,
1013,1013,1013,1014,1014,1014,1014,1014,1015,1015,1015,1015,1016,1016,1016,1016,
1016,1016,1017,1017,1017,1017,1017,1018,1018,1018,1018,1018,1018,1019,1019,1019,
1019,1019,1019,1020,1020,1020,1020,1020,1020,1020,1020,1021,1021,1021,1021,1021,
1021,1021,1021,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1023,1023,1023,
1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1024,1024,1024,1024,
1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,
1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,
1024,1024,1024,1024,1024,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,
1023,1023,1023,1023,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1021,1021,
1021,1021,1021,1021,1021,1021,1020,1020,1020,1020,1020,1020,1020,1020,1019,1019,
1019,1019,1019,1019,1018,1018,1018,1018,1018,1018,1017,1017,1017,1017,1017,1016,
1016,1016,1016,1016,1016,1015,1015,1015,1015,1014,1014,1014,1014,1014,1013,1013,
1013,1013,1012,1012,1012,1012,1011,1011,1011,1011,1010,1010,1010,1010,1009,1009,
1009,1009,1008,1008,1008,1008,1007,1007,1007,1006,1006,1006,1006,1005,1005,1005,
1004,1004,1004,1003,1003,1003,1002,1002,1002,1001,1001,1001,1000,1000,1000,999,
999,999,998,998,998,997,997,997,996,996,996,995,995,994,994,994,
993,993,993,992,992,991,991,991,990,990,989,989,989,988,988,987,
987,986,986,986,985,985,984,984,983,983,983,982,982,981,981,980,
980,979,979,979,978,978,977,977,976,976,975,975,974,974,973,973,
972,972,971,971,970,970,969,969,968,968,967,967,966,966,965,965,
964,964,963,963,962,961,961,960,960,959,959,958,958,957,957,956,
955,955,954,954,953,953,952,951,951,950,950,949,948,948,947,947,
946,945,945,944,944,943,942,942,941,941,940,939,939,938,937,937,
936,936,935,934,934,933,932,932,931,930,930,929,928,928,927,926,
926,925,924,924,923,922,922,921,920,920,919,918,917,917,916,915,
915,914,913,913,912,911,910,910,909,908,907,907,906,905,905,904,
903,902,902,901,900,899,899,898,897,896,896,895,894,893,893,892,
891,890,889,889,888,887,886,885,885,884,883,882,882,881,880,879,
878,878,877,876,875,874,873,873,872,871,870,869,868,868,867,866,
865,864,863,863,862,861,860,859,858,857,857,856,855,854,853,852,
851,851,850,849,848,847,846,845,844,843,843,842,841,840,839,838,
837,836,835,834,834,833,832,831,830,829,828,827,826,825,824,823,
822,822,821,820,819,818,817,816,815,814,813,812,811,810,809,808,
807,806,805,804,803,802,801,800,799,798,798,797,796,795,794,793,
792,791,790,789,788,787,786,785,784,783,782,780,779,778,777,776,
775,774,773,772,771,770,769,768,767,766,765,764,763,762,761,760,
759,758,757,756,755,753,752,751,750,749,748,747,746,745,744,743,
742,741,739,738,737,736,735,734,733,732,731,730,729,727,726,725,
724,723,722,721,720,719,717,716,715,714,713,712,711,709,708,707,
706,705,704,703,702,700,699,698,697,696,695,693,692,691,690,689,
688,687,685,684,683,682,681,679,678,677,676,675,674,672,671,670,
669,668,666,665,664,663,662,660,659,658,657,656,654,653,652,651,
650,648,647,646,645,644,642,641,640,639,637,636,635,634,632,631,
630,629,628,626,625,624,623,621,620,619,618,616,615,614,613,611,
610,609,607,606,605,604,602,601,600,599,597,596,595,593,592,591,
590,588,587,586,584,583,582,581,579,578,577,575,574,573,572,570,
569,568,566,565,564,562,561,560,558,557,556,554,553,552,550,549,
548,547,545,544,543,541,540,539,537,536,535,533,532,530,529,528,
526,525,524,522,521,520,518,517,516,514,513,512,510,509,507,506,
505,503,502,501,499,498,497,495,494,492,491,490,488,487,485,484,
483,481,480,479,477,476,474,473,472,470,469,467,466,465,463,462,
460,459,458,456,455,453,452,451,449,448,446,445,443,442,441,439,
438,436,435,434,432,431,429,428,426,425,424,422,421,419,418,416,
415,414,412,411,409,408,406,405,403,402,401,399,398,396,395,393,
392,390,389,388,386,385,383,382,380,379,377,376,374,373,371,370,
369,367,366,364,363,361,360,358,357,355,354,352,351,349,348,346,
345,343,342,341,339,338,336,335,333,332,330,329,327,326,324,323,
321,320,318,317,315,314,312,311,309,308,306,305,303,302,300,299,
297,296,294,293,291,290,288,287,285,284,282,281,279,278,276,275,
273,272,270,269,267,266,264,263,261,259,258,256,255,253,252,250,
249,247,246,244,243,241,240,238,237,235,234,232,230,229,227,226,
224,223,221,220,218,217,215,214,212,211,209,207,206,204,203,201,
200,198,197,195,194,192,191,189,187,186,184,183,181,180,178,177,
175,174,172,170,169,167,166,164,163,161,160,158,156,155,153,152,
150,149,147,146,144,142,141,139,138,136,135,133,132,130,128,127,
125,124,122,121,119,118,116,114,113,111,110,108,107,105,103,102,
100,99,97,96,94,93,91,89,88,86,85,83,82,80,78,77,
75,74,72,71,69,67,66,64,63,61,60,58,57,55,53,52,
50,49,47,46,44,42,41,39,38,36,35,33,31,30,28,27,
25,24,22,20,19,17,16,14,13,11,9,8,6,5,3,2,
0,-2,-3,-5,-6,-8,-9,-11,-13,-14,-16,-17,-19,-20,-22,-24,
-25,-27,-28,-30,-31,-33,-35,-36,-38,-39,-41,-42,-44,-46,-47,-49,
-50,-52,-53,-55,-57,-58,-60,-61,-63,-64,-66,-67,-69,-71,-72,-74,
-75,-77,-78,-80,-82,-83,-85,-86,-88,-89,-91,-93,-94,-96,-97,-99,
-100,-102,-103,-105,-107,-108,-110,-111,-113,-114,-116,-118,-119,-121,-122,-124,
-125,-127,-128,-130,-132,-133,-135,-136,-138,-139,-141,-142,-144,-146,-147,-149,
-150,-152,-153,-155,-156,-158,-160,-161,-163,-164,-166,-167,-169,-170,-172,-174,
-175,-177,-178,-180,-181,-183,-184,-186,-187,-189,-191,-192,-194,-195,-197,-198,
-200,-201,-203,-204,-206,-207,-209,-211,-212,-214,-215,-217,-218,-220,-221,-223,
-224,-226,-227,-229,-230,-232,-234,-235,-237,-238,-240,-241,-243,-244,-246,-247,
-249,-250,-252,-253,-255,-256,-258,-259,-261,-263,-264,-266,-267,-269,-270,-272,
-273,-275,-276,-278,-279,-281,-282,-284,-285,-287,-288,-290,-291,-293,-294,-296,
-297,-299,-300,-302,-303,-305,-306,-308,-309,-311,-312,-314,-315,-317,-318,-320,
-321,-323,-324,-326,-327,-329,-330,-332,-333,-335,-336,-338,-339,-341,-342,-343,
-345,-346,-348,-349,-351,-352,-354,-355,-357,-358,-360,-361,-363,-364,-366,-367,
-369,-370,-371,-373,-374,-376,-377,-379,-380,-382,-383,-385,-386,-388,-389,-390,
-392,-393,-395,-396,-398,-399,-401,-402,-403,-405,-406,-408,-409,-411,-412,-414,
-415,-416,-418,-419,-421,-422,-424,-425,-426,-428,-429,-431,-432,-434,-435,-436,
-438,-439,-441,-442,-443,-445,-446,-448,-449,-451,-452,-453,-455,-456,-458,-459,
-460,-462,-463,-465,-466,-467,-469,-470,-472,-473,-474,-476,-477,-479,-480,-481,
-483,-484,-485,-487,-488,-490,-491,-492,-494,-495,-497,-498,-499,-501,-502,-503,
-505,-506,-507,-509,-510,-512,-513,-514,-516,-517,-518,-520,-521,-522,-524,-525,
-526,-528,-529,-530,-532,-533,-535,-536,-537,-539,-540,-541,-543,-544,-545,-547,
-548,-549,-550,-552,-553,-554,-556,-557,-558,-560,-561,-562,-564,-565,-566,-568,
-569,-570,-572,-573,-574,-575,-577,-578,-579,-581,-582,-583,-584,-586,-587,-588,
-590,-591,-592,-593,-595,-596,-597,-599,-600,-601,-602,-604,-605,-606,-607,-609,
-610,-611,-613,-614,-615,-616,-618,-619,-620,-621,-623,-624,-625,-626,-628,-629,
-630,-631,-632,-634,-635,-636,-637,-639,-640,-641,-642,-644,-645,-646,-647,-648,
-650,-651,-652,-653,-654,-656,-657,-658,-659,-660,-662,-663,-664,-665,-666,-668,
-669,-670,-671,-672,-674,-675,-676,-677,-678,-679,-681,-682,-683,-684,-685,-687,
-688,-689,-690,-691,-692,-693,-695,-696,-697,-698,-699,-700,-702,-703,-704,-705,
-706,-707,-708,-709,-711,-712,-713,-714,-715,-716,-717,-719,-720,-721,-722,-723,
-724,-725,-726,-727,-729,-730,-731,-732,-733,-734,-735,-736,-737,-738,-739,-741,
-742,-743,-744,-745,-746,-747,-748,-749,-750,-751,-752,-753,-755,-756,-757,-758,
-759,-760,-761,-762,-763,-764,-765,-766,-767,-768,-769,-770,-771,-772,-773,-774,
-775,-776,-777,-778,-779,-780,-782,-783,-784,-785,-786,-787,-788,-789,-790,-791,
-792,-793,-794,-795,-796,-797,-798,-798,-799,-800,-801,-802,-803,-804,-805,-806,
-807,-808,-809,-810,-811,-812,-813,-814,-815,-816,-817,-818,-819,-820,-821,-822,
-822,-823,-824,-825,-826,-827,-828,-829,-830,-831,-832,-833,-834,-834,-835,-836,
-837,-838,-839,-840,-841,-842,-843,-843,-844,-845,-846,-847,-848,-849,-850,-851,
-851,-852,-853,-854,-855,-856,-857,-857,-858,-859,-860,-861,-862,-863,-863,-864,
-865,-866,-867,-868,-868,-869,-870,-871,-872,-873,-873,-874,-875,-876,-877,-878,
-878,-879,-880,-881,-882,-882,-883,-884,-885,-885,-886,-887,-888,-889,-889,-890,
-891,-892,-893,-893,-894,-895,-896,-896,-897,-898,-899,-899,-900,-901,-902,-902,
-903,-904,-905,-905,-906,-907,-907,-908,-909,-910,-910,-911,-912,-913,-913,-914,
-915,-915,-916,-917,-917,-918,-919,-920,-920,-921,-922,-922,-923,-924,-924,-925,
-926,-926,-927,-928,-928,-929,-930,-930,-931,-932,-932,-933,-934,-934,-935,-936,
-936,-937,-937,-938,-939,-939,-940,-941,-941,-942,-942,-943,-944,-944,-945,-945,
-946,-947,-947,-948,-948,-949,-950,-950,-951,-951,-952,-953,-953,-954,-954,-955,
-955,-956,-957,-957,-958,-958,-959,-959,-960,-960,-961,-961,-962,-963,-963,-964,
-964,-965,-965,-966,-966,-967,-967,-968,-968,-969,-969,-970,-970,-971,-971,-972,
-972,-973,-973,-974,-974,-975,-975,-976,-976,-977,-977,-978,-978,-979,-979,-979,
-980,-980,-981,-981,-982,-982,-983,-983,-983,-984,-984,-985,-985,-986,-986,-986,
-987,-987,-988,-988,-989,-989,-989,-990,-990,-991,-991,-991,-992,-992,-993,-993,
-993,-994,-994,-994,-995,-995,-996,-996,-996,-997,-997,-997,-998,-998,-998,-999,
-999,-999,-1000,-1000,-1000,-1001,-1001,-1001,-1002,-1002,-1002,-1003,-1003,-1003,-1004,-1004,
-1004,-1005,-1005,-1005,-1006,-1006,-1006,-1006,-1007,-1007,-1007,-1008,-1008,-1008,-1008,-1009,
-1009,-1009,-1009,-1010,-1010,-1010,-1010,-1011,-1011,-1011,-1011,-1012,-1012,-1012,-1012,-1013,
-1013,-1013,-1013,-1014,-1014,-1014,-1014,-1014,-1015,-1015,-1015,-1015,-1016,-1016,-1016,-1016,
-1016,-1016,-1017,-1017,-1017,-1017,-1017,-1018,-1018,-1018,-1018,-1018,-1018,-1019,-1019,-1019,
-1019,-1019,-1019,-1020,-1020,-1020,-1020,-1020,-1020,-1020,-1020,-1021,-1021,-1021,-1021,-1021,
-1021,-1021,-1021,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1023,-1023,-1023,
-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1024,-1024,-1024,-1024,
-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
-1024,-1024,-1024,-1024,-1024,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,
-1023,-1023,-1023,-1023,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1021,-1021,
-1021,-1021,-1021,-1021,-1021,-1021,-1020,-1020,-1020,-1020,-1020,-1020,-1020,-1020,-1019,-1019,
-1019,-1019,-1019,-1019,-1018,-1018,-1018,-1018,-1018,-1018,-1017,-1017,-1017,-1017,-1017,-1016,
-1016,-1016,-1016,-1016,-1016,-1015,-1015,-1015,-1015,-1014,-1014,-1014,-1014,-1014,-1013,-1013,
-1013,-1013,-1012,-1012,-1012,-1012,-1011,-1011,-1011,-1011,-1010,-1010,-1010,-1010,-1009,-1009,
-1009,-1009,-1008,-1008,-1008,-1008,-1007,-1007,-1007,-1006,-1006,-1006,-1006,-1005,-1005,-1005,
-1004,-1004,-1004,-1003,-1003,-1003,-1002,-1002,-1002,-1001,-1001,-1001,-1000,-1000,-1000,-999,
-999,-999,-998,-998,-998,-997,-997,-997,-996,-996,-996,-995,-995,-994,-994,-994,
-993,-993,-993,-992,-992,-991,-991,-991,-990,-990,-989,-989,-989,-988,-988,-987,
-987,-986,-986,-986,-985,-985,-984,-984,-983,-983,-983,-982,-982,-981,-981,-980,
-980,-979,-979,-979,-978,-978,-977,-977,-976,-976,-975,-975,-974,-974,-973,-973,
-972,-972,-971,-971,-970,-970,-969,-969,-968,-968,-967,-967,-966,-966,-965,-965,
-964,-964,-963,-963,-962,-961,-961,-960,-960,-959,-959,-958,-958,-957,-957,-956,
-955,-955,-954,-954,-953,-953,-952,-951,-951,-950,-950,-949,-948,-948,-947,-947,
-946,-945,-945,-944,-944,-943,-942,-942,-941,-941,-940,-939,-939,-938,-937,-937,
-936,-936,-935,-934,-934,-933,-932,-932,-931,-930,-930,-929,-928,-928,-927,-926,
-926,-925,-924,-924,-923,-922,-922,-921,-920,-920,-919,-918,-917,-917,-916,-915,
-915,-914,-913,-913,-912,-911,-910,-910,-909,-908,-907,-907,-906,-905,-905,-904,
-903,-902,-902,-901,-900,-899,-899,-898,-897,-896,-896,-895,-894,-893,-893,-892,
-891,-890,-889,-889,-888,-887,-886,-885,-885,-884,-883,-882,-882,-881,-880,-879,
-878,-878,-877,-876,-875,-874,-873,-873,-872,-871,-870,-869,-868,-868,-867,-866,
-865,-864,-863,-863,-862,-861,-860,-859,-858,-857,-857,-856,-855,-854,-853,-852,
-851,-851,-850,-849,-848,-847,-846,-845,-844,-843,-843,-842,-841,-840,-839,-838,
-837,-836,-835,-834,-834,-833,-832,-831,-830,-829,-828,-827,-826,-825,-824,-823,
-822,-822,-821,-820,-819,-818,-817,-816,-815,-814,-813,-812,-811,-810,-809,-808,
-807,-806,-805,-804,-803,-802,-801,-800,-799,-798,-798,-797,-796,-795,-794,-793,
-792,-791,-790,-789,-788,-787,-786,-785,-784,-783,-782,-780,-779,-778,-777,-776,
-775,-774,-773,-772,-771,-770,-769,-768,-767,-766,-765,-764,-763,-762,-761,-760,
-759,-758,-757,-756,-755,-753,-752,-751,-750,-749,-748,-747,-746,-745,-744,-743,
-742,-741,-739,-738,-737,-736,-735,-734,-733,-732,-731,-730,-729,-727,-726,-725,
-724,-723,-722,-721,-720,-719,-717,-716,-715,-714,-713,-712,-711,-709,-708,-707,
-706,-705,-704,-703,-702,-700,-699,-698,-697,-696,-695,-693,-692,-691,-690,-689,
-688,-687,-685,-684,-683,-682,-681,-679,-678,-677,-676,-675,-674,-672,-671,-670,
-669,-668,-666,-665,-664,-663,-662,-660,-659,-658,-657,-656,-654,-653,-652,-651,
-650,-648,-647,-646,-645,-644,-642,-641,-640,-639,-637,-636,-635,-634,-632,-631,
-630,-629,-628,-626,-625,-624,-623,-621,-620,-619,-618,-616,-615,-614,-613,-611,
-610,-609,-607,-606,-605,-604,-602,-601,-600,-599,-597,-596,-595,-593,-592,-591,
-590,-588,-587,-586,-584,-583,-582,-581,-579,-578,-577,-575,-574,-573,-572,-570,
-569,-568,-566,-565,-564,-562,-561,-560,-558,-557,-556,-554,-553,-552,-550,-549,
-548,-547,-545,-544,-543,-541,-540,-539,-537,-536,-535,-533,-532,-530,-529,-528,
-526,-525,-524,-522,-521,-520,-518,-517,-516,-514,-513,-512,-510,-509,-507,-506,
-505,-503,-502,-501,-499,-498,-497,-495,-494,-492,-491,-490,-488,-487,-485,-484,
-483,-481,-480,-479,-477,-476,-474,-473,-472,-470,-469,-467,-466,-465,-463,-462,
-460,-459,-458,-456,-455,-453,-452,-451,-449,-448,-446,-445,-443,-442,-441,-439,
-438,-436,-435,-434,-432,-431,-429,-428,-426,-425,-424,-422,-421,-419,-418,-416,
-415,-414,-412,-411,-409,-408,-406,-405,-403,-402,-401,-399,-398,-396,-395,-393,
-392,-390,-389,-388,-386,-385,-383,-382,-380,-379,-377,-376,-374,-373,-371,-370,
-369,-367,-366,-364,-363,-361,-360,-358,-357,-355,-354,-352,-351,-349,-348,-346,
-345,-343,-342,-341,-339,-338,-336,-335,-333,-332,-330,-329,-327,-326,-324,-323,
-321,-320,-318,-317,-315,-314,-312,-311,-309,-308,-306,-305,-303,-302,-300,-299,
-297,-296,-294,-293,-291,-290,-288,-287,-285,-284,-282,-281,-279,-278,-276,-275,
-273,-272,-270,-269,-267,-266,-264,-263,-261,-259,-258,-256,-255,-253,-252,-250,
-249,-247,-246,-244,-243,-241,-240,-238,-237,-235,-234,-232,-230,-229,-227,-226,
-224,-223,-221,-220,-218,-217,-215,-214,-212,-211,-209,-207,-206,-204,-203,-201,
-200,-198,-197,-195,-194,-192,-191,-189,-187,-186,-184,-183,-181,-180,-178,-177,
-175,-174,-172,-170,-169,-167,-166,-164,-163,-161,-160,-158,-156,-155,-153,-152,
-150,-149,-147,-146,-144,-142,-141,-139,-138,-136,-135,-133,-132,-130,-128,-127,
-125,-124,-122,-121,-119,-118,-116,-114,-113,-111,-110,-108,-107,-105,-103,-102,
-100,-99,-97,-96,-94,-93,-91,-89,-88,-86,-85,-83,-82,-80,-78,-77,
-75,-74,-72,-71,-69,-67,-66,-64,-63,-61,-60,-58,-57,-55,-53,-52,
-50,-49,-47,-46,-44,-42,-41,-39,-38,-36,-35,-33,-31,-30,-28,-27,
-25,-24,-22,-20,-19,-17,-16,-14,-13,-11,-9,-8,-6,-5,-3,-2,
0,2,3,5,6,8,9,11,13,14,16,17,19,20,22,24,
25,27,28,30,31,33,35,36,38,39,41,42,44,46,47,49,
50,52,53,55,57,58,60,61,63,64,66,67,69,71,72,74,
75,77,78,80,82,83,85,86,88,89,91,93,94,96,97,99,
100,102,103,105,107,108,110,111,113,114,116,118,119,121,122,124,
125,127,128,130,132,133,135,136,138,139,141,142,144,146,147,149,
150,152,153,155,156,158,160,161,163,164,166,167,169,170,172,174,
175,177,178,180,181,183,184,186,187,189,191,192,194,195,197,198,
200,201,203,204,206,207,209,211,212,214,215,217,218,220,221,223,
224,226,227,229,230,232,234,235,237,238,240,241,243,244,246,247,
249,250,252,253,255,256,258,259,261,263,264,266,267,269,270,272,
273,275,276,278,279,281,282,284,285,287,288,290,291,293,294,296,
297,299,300,302,303,305,306,308,309,311,312,314,315,317,318,320,
321,323,324,326,327,329,330,332,333,335,336,338,339,341,342,343,
345,346,348,349,351,352,354,355,357,358,360,361,363,364,366,367,
369,370,371,373,374,376,377,379,380,382,383,385,386,388,389,390,
392,393,395,396,398,399,401,402,403,405,406,408,409,411,412,414,
415,416,418,419,421,422,424,425,426,428,429,431,432,434,435,436,
438,439,441,442,443,445,446,448,449,451,452,453,455,456,458,459,
460,462,463,465,466,467,469,470,472,473,474,476,477,479,480,481,
483,484,485,487,488,490,491,492,494,495,497,498,499,501,502,503,
505,506,507,509,510,512,513,514,516,517,518,520,521,522,524,525,
526,528,529,530,532,533,535,536,537,539,540,541,543,544,545,547,
548,549,550,552,553,554,556,557,558,560,561,562,564,565,566,568,
569,570,572,573,574,575,577,578,579,581,582,583,584,586,587,588,
590,591,592,593,595,596,597,599,600,601,602,604,605,606,607,609,
610,611,613,614,615,616,618,619,620,621,623,624,625,626,628,629,
630,631,632,634,635,636,637,639,640,641,642,644,645,646,647,648,
650,651,652,653,654,656,657,658,659,660,662,663,664,665,666,668,
669,670,671,672,674,675,676,677,678,679,681,682,683,684,685,687,
688,689,690,691,692,693,695,696,697,698,699,700,702,703,704,705,
706,707,708,709,711,712,713,714,715,716,717,719,720,721,722,723,
724,725,726,727,729,730,731,732,733,734,735,736,737,738,739,741,
742,743,744,745,746,747,748,749,750,751,752,753,755,756,757,758,
759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,
775,776,777,778,779,780,782,783,784,785,786,787,788,789,790,791,
792,793,794,795,796,797,798,798,799,800,801,802,803,804,805,806,
807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,
822,823,824,825,826,827,828,829,830,831,832,833,834,834,835,836,
837,838,839,840,841,842,843,843,844,845,846,847,848,849,850,851,
851,852,853,854,855,856,857,857,858,859,860,861,862,863,863,864,
865,866,867,868,868,869,870,871,872,873,873,874,875,876,877,878,
878,879,880,881,882,882,883,884,885,885,886,887,888,889,889,890,
891,892,893,893,894,895,896,896,897,898,899,899,900,901,902,902,
903,904,905,905,906,907,907,908,909,910,910,911,912,913,913,914,
915,915,916,917,917,918,919,920,920,921,922,922,923,924,924,925,
926,926,927,928,928,929,930,930,931,932,932,933,934,934,935,936,
936,937,937,938,939,939,940,941,941,942,942,943,944,944,945,945,
946,947,947,948,948,949,950,950,951,951,952,953,953,954,954,955,
955,956,957,957,958,958,959,959,960,960,961,961,962,963,963,964,
964,965,965,966,966,967,967,968,968,969,969,970,970,971,971,972,
972,973,973,974,974,975,975,976,976,977,977,978,978,979,979,979,
980,980,981,981,982,982,983,983,983,984,984,985,985,986,986,986,
987,987,988,988,989,989,989,990,990,991,991,991,992,992,993,993,
993,994,994,994,995,995,996,996,996,997,997,997,998,998,998,999,
999,999,1000,1000,1000,1001,1001,1001,1002,1002,1002,1003,1003,1003,1004,1004,
1004,1005,1005,1005,1006,1006,1006,1006,1007,1007,1007,1008,1008,1008,1008,1009,
1009,1009,1009,1010,1010,1010,1010,1011,1011,1011,1011,1012,1012,1012,1012,1013,
1013,1013,1013,1014,1014,1014,1014,1014,1015,1015,1015,1015,1016,1016,1016,1016,
1016,1016,1017,1017,1017,1017,1017,1018,1018,1018,1018,1018,1018,1019,1019,1019,
1019,1019,1019,1020,1020,1020,1020,1020,1020,1020,1020,1021,1021,1021,1021,1021,
1021,1021,1021,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1023,1023,1023,
1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1023,1024,1024,1024,1024,
1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,
};

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
int tantab[TABSIZE / 4] = {
0,2,3,5,6,8,9,11,13,14,16,17,19,20,22,24,
25,27,28,30,31,33,35,36,38,39,41,42,44,46,47,49,
50,52,53,55,57,58,60,61,63,64,66,68,69,71,72,74,
76,77,79,80,82,83,85,87,88,90,91,93,95,96,98,99,
101,102,104,106,107,109,110,112,114,115,117,118,120,122,123,125,
126,128,129,131,133,134,136,137,139,141,142,144,145,147,149,150,
152,154,155,157,158,160,162,163,165,166,168,170,171,173,174,176,
178,179,181,183,184,186,187,189,191,192,194,196,197,199,200,202,
204,205,207,209,210,212,214,215,217,218,220,222,223,225,227,228,
230,232,233,235,237,238,240,242,243,245,247,248,250,251,253,255,
256,258,260,262,263,265,267,268,270,272,273,275,277,278,280,282,
283,285,287,288,290,292,294,295,297,299,300,302,304,305,307,309,
311,312,314,316,318,319,321,323,324,326,328,330,331,333,335,337,
338,340,342,344,345,347,349,351,352,354,356,358,359,361,363,365,
366,368,370,372,373,375,377,379,381,382,384,386,388,390,391,393,
395,397,399,400,402,404,406,408,410,411,413,415,417,419,420,422,
424,426,428,430,432,433,435,437,439,441,443,445,446,448,450,452,
454,456,458,460,461,463,465,467,469,471,473,475,477,479,480,482,
484,486,488,490,492,494,496,498,500,502,504,506,508,510,512,513,
515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,
547,549,551,553,555,557,560,562,564,566,568,570,572,574,576,578,
580,582,584,586,588,591,593,595,597,599,601,603,605,607,609,612,
614,616,618,620,622,624,627,629,631,633,635,637,640,642,644,646,
648,651,653,655,657,659,662,664,666,668,671,673,675,677,680,682,
684,686,689,691,693,696,698,700,703,705,707,709,712,714,716,719,
721,724,726,728,731,733,735,738,740,743,745,747,750,752,755,757,
759,762,764,767,769,772,774,777,779,782,784,787,789,792,794,797,
799,802,804,807,809,812,814,817,820,822,825,827,830,833,835,838,
840,843,846,848,851,854,856,859,862,864,867,870,872,875,878,881,
883,886,889,892,894,897,900,903,905,908,911,914,917,920,922,925,
928,931,934,937,940,943,945,948,951,954,957,960,963,966,969,972,
975,978,981,984,987,990,993,996,999,1002,1005,1008,1012,1015,1018,1021,
1024,1027,1030,1033,1037,1040,1043,1046,1049,1053,1056,1059,1062,1066,1069,1072,
1076,1079,1082,1086,1089,1092,1096,1099,1102,1106,1109,1113,1116,1119,1123,1126,
1130,1133,1137,1140,1144,1147,1151,1154,1158,1162,1165,1169,1172,1176,1180,1183,
1187,1191,1194,1198,1202,1206,1209,1213,1217,1221,1225,1228,1232,1236,1240,1244,
1248,1252,1256,1260,1263,1267,1271,1275,1279,1283,1288,1292,1296,1300,1304,1308,
1312,1316,1320,1325,1329,1333,1337,1342,1346,1350,1354,1359,1363,1368,1372,1376,
1381,1385,1390,1394,1399,1403,1408,1412,1417,1421,1426,1431,1435,1440,1445,1449,
1454,1459,1463,1468,1473,1478,1483,1488,1493,1497,1502,1507,1512,1517,1522,1527,
1533,1538,1543,1548,1553,1558,1563,1569,1574,1579,1585,1590,1595,1601,1606,1612,
1617,1623,1628,1634,1639,1645,1650,1656,1662,1668,1673,1679,1685,1691,1697,1703,
1708,1714,1720,1726,1732,1739,1745,1751,1757,1763,1769,1776,1782,1788,1795,1801,
1808,1814,1821,1827,1834,1840,1847,1854,1860,1867,1874,1881,1888,1895,1902,1909,
1916,1923,1930,1937,1944,1952,1959,1966,1974,1981,1989,1996,2004,2011,2019,2027,
2034,2042,2050,2058,2066,2074,2082,2090,2098,2106,2114,2123,2131,2140,2148,2157,
2165,2174,2182,2191,2200,2209,2218,2227,2236,2245,2254,2263,2272,2282,2291,2301,
2310,2320,2329,2339,2349,2359,2369,2379,2389,2399,2409,2419,2430,2440,2451,2461,
2472,2483,2494,2505,2516,2527,2538,2549,2561,2572,2584,2595,2607,2619,2631,2643,
2655,2667,2679,2691,2704,2716,2729,2742,2755,2768,2781,2794,2807,2821,2834,2848,
2862,2876,2890,2904,2918,2933,2947,2962,2977,2991,3007,3022,3037,3052,3068,3084,
3100,3116,3132,3148,3165,3181,3198,3215,3232,3250,3267,3285,3303,3321,3339,3357,
3376,3394,3413,3432,3452,3471,3491,3511,3531,3551,3572,3593,3614,3635,3657,3678,
3700,3722,3745,3768,3791,3814,3837,3861,3885,3909,3934,3959,3984,4010,4035,4062,
4088,4115,4142,4169,4197,4225,4254,4283,4312,4341,4371,4402,4433,4464,4496,4528,
4560,4593,4626,4660,4695,4729,4765,4801,4837,4874,4911,4949,4988,5027,5067,5107,
5148,5190,5232,5275,5318,5363,5408,5453,5500,5547,5595,5644,5694,5744,5796,5848,
5901,5956,6011,6067,6124,6183,6242,6302,6364,6427,6491,6556,6623,6691,6760,6831,
6903,6977,7052,7129,7208,7288,7370,7454,7540,7627,7717,7809,7903,7999,8098,8199,
8302,8409,8517,8629,8744,8861,8982,9106,9234,9365,9500,9638,9781,9928,10080,10236,
10397,10563,10734,10911,11094,11283,11479,11681,11891,12108,12334,12567,12810,13062,13325,13598,
13882,14178,14488,14811,15148,15502,15872,16260,16668,17096,17547,18022,18524,19054,19616,20211,
20844,21517,22236,23004,23826,24710,25661,26689,27802,29012,30331,31777,33367,35124,37076,39259,
41713,44495,47675,51343,55622,60680,55296,45568,45824,13568,30720,50944,19200,51712,60416,38144,
};

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
int atantab[256] = {
0,41,81,122,163,204,244,285,326,367,407,448,489,529,570,610,
651,692,732,773,813,854,894,935,975,1015,1056,1096,1136,1177,1217,1257,
1297,1337,1377,1417,1457,1497,1537,1577,1617,1656,1696,1736,1775,1815,1854,1894,
1933,1973,2012,2051,2090,2129,2168,2207,2246,2285,2324,2363,2401,2440,2478,2517,
2555,2594,2632,2670,2708,2746,2784,2822,2860,2897,2935,2973,3010,3047,3085,3122,
3159,3196,3233,3270,3307,3344,3380,3417,3453,3490,3526,3562,3599,3635,3670,3706,
3742,3778,3813,3849,3884,3920,3955,3990,4025,4060,4095,4129,4164,4199,4233,4267,
4302,4336,4370,4404,4438,4471,4505,4539,4572,4605,4639,4672,4705,4738,4771,4803,
4836,4869,4901,4933,4966,4998,5030,5062,5094,5125,5157,5188,5220,5251,5282,5313,
5344,5375,5406,5437,5467,5498,5528,5559,5589,5619,5649,5679,5708,5738,5768,5797,
5826,5856,5885,5914,5943,5972,6000,6029,6058,6086,6114,6142,6171,6199,6227,6254,
6282,6310,6337,6365,6392,6419,6446,6473,6500,6527,6554,6580,6607,6633,6660,6686,
6712,6738,6764,6790,6815,6841,6867,6892,6917,6943,6968,6993,7018,7043,7068,7092,
7117,7141,7166,7190,7214,7238,7262,7286,7310,7334,7358,7381,7405,7428,7451,7475,
7498,7521,7544,7566,7589,7612,7635,7657,7679,7702,7724,7746,7768,7790,7812,7834,
7856,7877,7899,7920,7942,7963,7984,8005,8026,8047,8068,8089,8110,8131,8151,8172,
};

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
static int fast_atan_sub(int32 x, int32 y)
{
    if (x == 0) {
        return(0);
    }
    if (y == 0) {
        return(DEG_90);
    }
    if (y == x) {
        return(DEG_45);
    }
    if (y > x) {
        if (y < 0x10000L) {
            y <<= 7;
            x <<= 15;
            x /= y;
            return(atantab[x]);
        }
        else {
            y >>= 8;
            x /= y;
            return(atantab[x]);
        }
    }
    else {
        if (x < 0x10000L) {
            x <<= 7;
            y <<= 15;
            y /= x;
            return(DEG_90 - atantab[y]);
        }
        else {
            x >>= 8;
            y /= x;
            return(DEG_90 - atantab[y]);
        }
    }
}

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
// y = 0 degrees, x = 90 degrees, angle + clockwise, -180 -> +180
int fast_atan(int32 x, int32 y)
{
    if (y >= 0) {
        if (x >= 0) {
            return(fast_atan_sub(x, y));
        }
        else {
            return(-fast_atan_sub(-x, y));
        }
    }
    else {
        if (x >= 0) {
            return(DEG_90 + (DEG_90 - fast_atan_sub(x, -y)));
        }
        else {
            return(-DEG_90 - (DEG_90 - fast_atan_sub(-x, -y)));
        }
    }
}

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
int fast_tan(int a)
{
	unsigned a1;
	long v1, v2;

	if (a < 0) {
		if (a >= DEG(-50)) {
			return -tantab[-a >> ASHIFT];
		}
          else if (a >= DEG(-88)) {
			a = -a;
			a1 = a >> ASHIFT;
			v1 = tantab[a1];
			v2 = tantab[a1 + 1];
			a &= AMASK;
		  	if (a == 0) {
				return -v1;
               }
			else {
				return(-(v1 + DIV((v2 - v1) << ASHIFT, a)));
               }
		}
          else {
			return SLOWTAN(a);
		}
	}
     else if (a <= DEG(50)) {
		return tantab[a >> ASHIFT];
	}
     else if (a <= DEG(88)) {
		a1 = a >> ASHIFT;
		v1 = tantab[a1];
		v2 = tantab[a1 + 1];
		a &= AMASK;
		if (a == 0) {
			return v1;
          }
		else {
			return(v1 + DIV((v2 - v1) << ASHIFT, a));
          }
	}
     else {
		return SLOWTAN(a);
	}
}

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
/*
#include <stdio.h>

static int *scdata;
static unsigned int *tandata;

static void setup_trig()
{
    int i, size, tansize;
    float conv, v;

    size = TABSIZE;
    tansize = TABSIZE / 4;
    scdata = (int *)malloc(size * (unsigned)sizeof(int));
    tandata = (unsigned *)malloc(tansize * (unsigned)sizeof(int));
    if ((scdata == NULL) || (tandata == NULL)) {
        printf("Failed to allocate sin/cos/tan tables\n");
        exit(0);
    }
    conv = (float)(PI / (0.5 * TABSIZE));
    for (i = 0; i < size; i++) {
        v = (float)sin(i * conv) * SFACT;
        if (v >= 0.0)
            scdata[i] = (int)(v + 0.5);
        else
            scdata[i] = (int)(v - 0.5);
    }
    for (i = 0; i < tansize; i++) {
        v = (float)tan(i * conv) * SFACT;
        tandata[i] = (unsigned int)(v + 0.5);
    }
    for (i = 0; i < 256; i++)
        atantab[i] = (int)((RADTODEG * atan2((float)i, 256.0)) + 0.5);
}

static void print_tables()
{
    FILE *fp;
    int i, j, n;

    fp = fopen("tables", "w");
    fprintf(fp, "int sintab[TABSIZE] = {\n");
    for (n = 0, i = 0; i < ((TABSIZE + (TABSIZE / 4)) >> 4); i++) {
        for (j = 0; j < 16; j++) {
            fprintf(fp, "%d,", scdata[n++]);
        }
        fprintf(fp, "\n");
    }
    fprintf(fp, "};\n");
    fprintf(fp, "int tantab[TABSIZE / 4] = {\n");
    for (n = 0, i = 0; i < ((TABSIZE / 4) >> 4); i++) {
        for (j = 0; j < 16; j++) {
            fprintf(fp, "%ld,", (long)tandata[n++]);
        }
        fprintf(fp, "\n");
    }
    fprintf(fp, "};\n");
    fprintf(fp, "int atantab[256] = {\n");
    for (n = 0, i = 0; i < (256 >> 4); i++) {
        for (j = 0; j < 16; j++) {
            fprintf(fp, "%d,", atantab[n++]);
        }
        fprintf(fp, "\n");
    }
    fprintf(fp, "};\n");
    fclose(fp);
}

int main()
{
    setup_trig();
    print_tables();
    return 0;
}
*/
